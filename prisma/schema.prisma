// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL") // .env 파일의 값을 사용
}

// 1. users 테이블 설계
model User {
  id        String    @id @default(uuid()) // PK, 문자열 ID
  name      String
  userid    String    @unique // 로그인 ID (중복 불가)
  password  String    // 해시된 비밀번호
  gender    String?   // ?는 Null 가능
  phone     String?
  birthDate DateTime? // Date 대신 DateTime 사용 (Prisma/Postgres 호환성)
  smsConsent Boolean   @default(false)
  termsConsent Boolean   @default(true)
  paymentPassword String?
  createdAt DateTime  @default(now())
  socialAccounts SocialAccount[]

  // 1:N 관계 (나중에 추가할 테이블들)
  // createdRooms Room[]
  // participations RoomParticipant[]
  // reviews Review[]
  // reports Report[]
  // paymentMethods PaymentMethod[]
}

model SocialAccount {
  id             String   @id @default(uuid())
  provider       String
  providerUserId String
  email          String?
  displayName    String?
  profileImage   String?
  user           User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId         String
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  @@unique([provider, providerUserId])
}
